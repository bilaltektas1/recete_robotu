<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Yapay Zeka & Re√ßete Analiz Robotu</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#f5f5f5;
  --panel:#ffffff;
  --panel-soft:#f0f0f0;
  --line:rgba(0,0,0,.08);
  --text:#111827;
  --muted:#6b7280;

  --ham:#22c55e;
  --bobin:#38bdf8;
  --koli:#f59e0b;
  --yard:#a78bfa;

  --transition:.3s ease;
}

body.dark{
  --bg:#020617;
  --panel:#020617ee;
  --panel-soft:#050b22;
  --line:rgba(255,255,255,.15);
  --text:#e5e7eb;
  --muted:#9ca3af;
}

*{
  box-sizing:border-box;
  margin:0;
  padding:0;
  font-family:Inter,Segoe UI,Arial;
}

body{
  background:var(--bg);
  color:var(--text);
  transition:background var(--transition), color var(--transition);
}

/* üîí SABƒ∞T TEMA BUTONU */
.theme-toggle{
  position:fixed;
  top:12px;
  right:12px;
  z-index:2000;
  background:var(--panel);
  border:1px solid var(--line);
  padding:8px 12px;
  border-radius:14px;
  font-weight:700;
  cursor:pointer;
  box-shadow:0 6px 14px rgba(0,0,0,.15);
}

/* √úSTTEN BO≈ûLUK (tema butonu yazƒ±yƒ± kapatmasƒ±n) */
.app{
  max-width:980px;
  margin:auto;
  padding:72px 14px 16px;
}

/* BANNER */
.banner{
  border-radius:26px;
  padding:26px;
  background:linear-gradient(270deg,#22c55e,#38bdf8,#f59e0b,#a78bfa);
  background-size:800% 800%;
  animation:grad 20s ease infinite;
  color:#fff;
  margin-bottom:16px;
}

.banner h1{
  font-size:24px;
  margin-bottom:6px;
}

.banner span{
  font-size:14px;
}

@keyframes grad{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* SEARCH */
.search input{
  width:100%;
  padding:14px 16px;
  border-radius:18px;
  border:1px solid var(--line);
  background:var(--panel);
  color:var(--text);
  font-size:15px;
}

/* CARD */
.card{
  margin-top:14px;
  background:linear-gradient(180deg,var(--panel),var(--panel-soft));
  border:1px solid var(--line);
  border-radius:22px;
  padding:14px;
  cursor:pointer;
  transition:.25s;
}

.card:hover{
  transform:scale(1.015);
  box-shadow:0 12px 24px rgba(0,0,0,.15);
}

.card.active{
  outline:2px solid var(--ham);
}

.card-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.card-code{
  font-weight:800;
  font-size:16px;
}

.recipe{
  display:none;
  margin-top:14px;
}

.card.open .recipe{
  display:block;
}

/* TABLO SATIR */
.row{
  display:grid;
  grid-template-columns:1.1fr 1fr 2.8fr 1fr;
  gap:8px;
  padding:8px 4px;
  border-bottom:1px solid var(--line);
  font-size:13px;
  align-items:center;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.row div:first-child{
  font-size:15px;
  font-weight:600;
}

.row.ham{color:var(--ham);}
.row.bobin{color:var(--bobin);}
.row.koli{color:var(--koli);}
.row.yard{color:var(--yard);}

.col-muted{color:var(--muted);}

/* BUTONLAR */
.actions{
  display:flex;
  gap:10px;
  margin-top:16px;
}

.btn{
  flex:1;
  padding:14px;
  border:none;
  border-radius:16px;
  font-weight:800;
  color:#fff;
  cursor:pointer;
}

.btn-print{background:#22c55e;}
.btn-wa{background:#25D366;}

footer{
  margin:30px 0 10px;
  text-align:center;
  font-size:11px;
  color:var(--muted);
}

/* üì± ULTRA MOBƒ∞L */
@media(max-width:600px){
  .row{
    grid-template-columns:1.2fr 1fr 2.2fr 1fr;
    font-size:12px;
  }
  .row div:first-child{
    font-size:14px;
  }
}
</style>
</head>

<body>

<div class="theme-toggle" onclick="toggleTheme()">üåô Tema</div>

<div class="app">

  <div class="banner">
    <h1>Yapay Zeka & Re√ßete Analiz Robotu</h1>
    <span>Akƒ±llƒ± Stok ‚Ä¢ √úretim ‚Ä¢ Mobil Analiz</span>
  </div>

  <div class="search">
    <input id="search" placeholder="Stok kodu veya √ºr√ºn adƒ± yaz">
  </div>

  <div id="activeRecipe"></div>
  <div id="results"></div>

  <footer>¬© Bilal Tekta≈ü</footer>

<textarea id="RAW_DATA" style="display:none">
<!-- VERƒ∞ AYNI ‚Äì DEƒûƒ∞≈ûTƒ∞RME -->
</textarea>

</div>

<script>
const norm=s=>s.toLowerCase().replace(/ƒ±/g,"i");

const CATEGORY_RULES=[
 {label:"üåø Hammadde",cls:"ham",test:i=>/^07/.test(i.code)},
 {label:"üéû Bobin",cls:"bobin",test:i=>/opp|bobin|rulo/i.test(i.name)},
 {label:"üì¶ Koli",cls:"koli",test:i=>/koli|omk/i.test(i.name)}
];

function category(i){
 for(const r of CATEGORY_RULES) if(r.test(i)) return [r.label,r.cls];
 return ["üß© Yardƒ±mcƒ±","yard"];
}

function parseERP(text){
 const lines=text.split("\n");
 const products=[];
 let current=null;

 for(const raw of lines){
  if(!raw.trim()) continue;

  if(!raw.startsWith(" ") && /\t1,000000/.test(raw)){
    const p=raw.split(/\t+/);
    current={code:p[0],name:p[1],items:[]};
    products.push(current);
  }
  else if(current && raw.startsWith(" ")){
    const c=raw.trim().split(/\t+/);
    if(c.length>=3) current.items.push({code:c[0],name:c[1],qty:c[2]});
  }
 }
 return products;
}

const DATA=parseERP(document.getElementById("RAW_DATA").value);
const results=document.getElementById("results");

search.oninput=()=>{
 results.innerHTML="";
 const q=norm(search.value);
 if(!q) return;

 DATA.filter(p=>
   norm(p.code).includes(q) ||
   norm(p.name).includes(q) ||
   p.items.some(i=>norm(i.name).includes(q))
 ).forEach(p=>{
  const card=document.createElement("div");
  card.className="card";
  card.innerHTML=`
   <div class="card-head">
     <div class="card-code">${p.code}</div><span>‚åÑ</span>
   </div>
   <small>${p.name}</small>
   <div class="recipe">
     ${p.items.map(i=>{
       const [l,c]=category(i);
       return `<div class="row ${c}">
         <div>${l}</div>
         <div class="col-muted">${i.code}</div>
         <div>${i.name}</div>
         <div>${i.qty}</div>
       </div>`;
     }).join("")}
     <div class="actions">
       <button class="btn btn-print" onclick="event.stopPropagation();printRecipe(this)">üñ® Yazdƒ±r</button>
       <button class="btn btn-wa" onclick="event.stopPropagation();shareWA(this)">WhatsApp</button>
     </div>
   </div>
  `;
  card.onclick=()=>{
   document.querySelectorAll(".card").forEach(c=>c.classList.remove("open","active"));
   card.classList.add("open","active");
  };
  results.appendChild(card);
 });
};

function shareWA(btn){
 const card=btn.closest(".card");
 let t=`ü§ñ *Yapay Zeka & Re√ßete Analiz Robotu*\nüì¶ *${card.querySelector("small").innerText}*\n\n`;
 card.querySelectorAll(".row").forEach(r=>{
  const d=r.querySelectorAll("div");
  t+=`${d[0].innerText}\nüîπ ${d[1].innerText}\nüî∏ ${d[2].innerText}\n‚öñÔ∏è ${d[3].innerText}\n‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n`;
 });
 window.open("https://wa.me/?text="+encodeURIComponent(t),"_blank");
}

function printRecipe(btn){
 const card=btn.closest(".card");
 const w=window.open('');
 w.document.write('<html><body style="font-family:Inter;padding:20px">');
 w.document.write('<h2>'+card.querySelector("small").innerText+'</h2>');
 card.querySelectorAll(".row").forEach(r=>w.document.write(r.outerHTML));
 w.document.write('</body></html>');
 w.print();
}

function toggleTheme(){
 document.body.classList.toggle("dark");
 document.querySelector(".theme-toggle").innerText =
  document.body.classList.contains("dark") ? "‚òÄÔ∏è Tema" : "üåô Tema";
}
</script>

</body>
</html>
